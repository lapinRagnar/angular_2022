<div class="card">

    <div class="card-header text-white bg-info">
        s'enregistrer
    </div>

    <div class="card-body">

        <form (ngSubmit)="saveData() "  [formGroup]="registerForm" novalidate>

            <div class="row gx-3 gy-2 align-items-center">

                <div class="col-md-6 mb-3">
                    <label for="">nom</label>
                    <input 
                        type="text" 
                        class="form-control" 
                        placeholder="nom" 
                        id="lastName"
                        
                        formControlName="lastName"

                        [ngClass]=" {'is-invalid': registerForm.get('lastName')!.invalid && ( registerForm.get('lastName')!.dirty || registerForm.get('lastName')!.touched )  } "

                       
                    >

                    <!-- afficher les erreurs -->
                    <div class="invalid-feedback" >

                        <div *ngIf="registerForm.get('lastName')!.errors?.['required'] " >
                            Entrez notre nom
                        </div>

                        <div *ngIf="registerForm.get('lastName')!.errors?.['minlength'] " >
                            Minimum 4 caractères
                        </div>

                    </div>

                </div>


                <div class="col-md-6 mb-3">
                    <label for="">prenom</label>
                    <input 
                        type="text" 
                        class="form-control" 
                        placeholder="prenom" 

                        formControlName="firstName"
                        
                        [ngClass]=" {'is-invalid': registerForm.get('firstName')!.invalid && ( registerForm.get('firstName')!.dirty || registerForm.get('firstName')!.touched )  } "

                    >

                        <!-- afficher les erreurs -->
                        <div class="invalid-feedback" >

                            <div *ngIf="registerForm.get('firstName')!.errors?.['required'] " >
                                Entrez notre nom
                            </div>
    
                            <div *ngIf="registerForm.get('firstName')!.errors?.['minlength'] " >
                                Minimum 4 caractères
                            </div>
    
                        </div>

                </div>

            </div>


            <div 
                class="row gx-3 gy-2 align-items-center"
                formGroupName="emailGroup"    
            >

                <div class="col-md-6 mb-3">
                    <label for="">email</label>
                    <input 
                        type="email" 
                        class="form-control" 
                        placeholder="email" 
                        name="email"  

                        formControlName="email"

                        [ngClass]="{'is-invalid': errorMsg }"

                    >

                    <!-- afficher les erreurs -->
                    <div class="invalid-feedback" >
                        {{ errorMsg }}
                    </div>


                </div>

                <div class="col-md-6 mb-3">
                    <label for="confirmEmailId">confirmer l'email</label>
                    <input 
                        type="email" 
                        class="form-control" 
                        id="confirmEmailId" 
                        placeholder="confirmer l'email (requis) "
                        formControlName="confirmEmail"   
                        [ngClass]=" { 'is-invalid' : registerForm.get('emailGroup')!.errors || (
                            (registerForm.get('emailGroup.confirmEmail')!.touched || 
                            registerForm.get('emailGroup.confirmEmail')!.dirty
                            ) && !registerForm.get('emailGroup.confirmEmail')!.valid
                        )} " 
                    >

                    <div class="invalid-feedback">
                        <span *ngIf="registerForm.get('emailGroup.confirmEmail')!.errors?.['required']">
                            merci de retaper votre email
                        </span>
                        <span *ngIf="registerForm.get('emailGroup')!.errors?.['match']">
                            l'email ne correspond pas
                        </span>
                    </div>

                </div>


            </div>



            <div class="row">

                <div class="col-md-6 mb-3">
                    <label for="phoneId">téléphone</label>
                    <input 
                        type="tel" 
                        class="form-control" 
                        placeholder="numéro de téléphone"
                        formControlName="phone"
                        [ngClass]=" {'is-invalid' : !registerForm.get('phone')!.valid} "    
                    >

                    <div class="invalid-feedback">
                        <span *ngIf="registerForm.get('phone')!.errors?.['required'] ">
                            entrez votre numéro de téléphone
                        </span>
                    </div>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="">recevoir les notifications</label>
                    <div class="col-md-8">
                        <div class="form-check form-check-inline">
                            <label for="" class="form-check-label">
                                <input 
                                    type="radio" 
                                    class="form-check-input"
                                    value="email" 
                                    formControlName="notification" 
                                >
                                email
                            </label>
                        </div>
                        <div class="form-check form-check-inline">
                            <label for="" class="form-check-label">
                                <input 
                                    type="radio" 
                                    class="form-check-input"
                                    value="text"
                                    formControlName="notification"   
                                >
                                texte
                            </label>
                        </div>
                    </div>
                    
                </div>
            </div>


            <div class="row mb-3 "> 

                <div class="col-md-6">
                    <label for="ratingId">note</label>
                    <input 
                        type="number" 
                        id="ratingId" 
                        class="form-control"
                        formControlName="rating"   
                        [ngClass]=" 
                            {'is-invalid' : 
                                (registerForm.get('rating')!.touched ||
                                registerForm.get('rating')!.dirty) &&
                                !registerForm.get('rating')!.valid 
                            } 
                        
                        " 
                    >
                    
                    <div class="invalid-feedback">
                        <span *ngIf=" registerForm.get('rating')!.errors?.['rangeError'] ">
                            notez nos services clients entre 1 et 5
                        </span>
                    </div>

                </div>

                <div class="col-md-6">
                    <div class="form-check mt-4 pt-3">
                        <label for="sendCatalogId" class="form-check-label">
                            <input 
                                type="checkbox" 
                                class="form-check-input"
                                formControlName="sendCatalog"
                            >
                            Je veux plus d'option (recevoir la pub)
                        </label>
                    </div>
                </div>
            </div>

            <div *ngIf="registerForm.get('sendCatalog')!.value"> 

                <div formArrayName="addresses">


                    <div formGroupName="0">
    
                        <div class="row form-group mb-2">
                            <label class="col-md-2 col-form-label pt-0">
                                type
                            </label>
                            <div class="col-md-8">
                                <div class="form-check form-check-inline">
                                    <label for="" class="form-check-label">
                                        <input 
                                            type="radio" 
                                            class="form-check-input"
                                            formControlName="addressType"
                                            value="home"
                                        >
                                        Domicile
                                    </label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <label for="" class="form-check-label">
                                        <input 
                                            type="radio" 
                                            class="form-check-input"
                                            formControlName="addressType"
                                            value="work"
                                        >
                                        Lieu de travail
                                    </label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <label for="" class="form-check-label">
                                        <input 
                                            type="radio" 
                                            class="form-check-input"
                                            formControlName="addressType"
                                            value="other"
                                        >
                                        Autres
                                    </label>
                                </div>
                            </div>
                        </div>
        
                        <div class="row mb-3">
        
                            <div class="col-md-12">
                                <label for="">Adresse 1</label>
                                <input 
                                    type="text" 
                                    class="form-control"
                                    formControlName="street1"
                                >
                            </div>
        
                            <div class="col-md-12">
                                <label for="">Adresse 1</label>
                                <input 
                                    type="text" 
                                    class="form-control"
                                    formControlName="street2"
                                >
                            </div>
        
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="">Ville</label>
                                    <input 
                                        type="text" 
                                        class="form-control"
                                        formControlName="city"
                                    >
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label for="">departement</label>
                                    <select 
                                        name="" id="" 
                                        class="form-control"
                                        formControlName="state"    
                                    > 
                                        <option value="">Selectionner un département</option>
                                        <option value="A">A</option>
                                        <option value="B">B</option>
                                        <option value="C">C</option>
                                        <option value="D">D</option>
                                    </select>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label for="">code postale</label>  
                                    <input 
                                        type="number"
                                        class="form-control"
                                        formControlName="zip"
                                    >
                                </div>
                            </div>
                        </div>
    
                    </div>

                </div>

            </div> 

            <div class="text-right d-flex align-items-end">

                <button 
                    class="btn btn-outline-info me-2 align-items-end"
                    type="button"
                    (click)="fillFormData()"
                >
                    Remplir les champs par defaut
                </button>

                <button 
                    class="btn btn-info align-items-end" 
                    type="submit"
                    [disabled]="!registerForm.valid"
                >
                    sauvegarder
                </button>

            </div>


        </form>
    </div>

</div>

<hr>

<p> dirt : {{ registerForm.dirty }} </p>
<p> pristine : {{ registerForm.pristine }} </p>
<p> valid : {{ registerForm.valid }} </p>
<p> invalid : {{ registerForm.invalid }} </p>
<p>value: </p>
<pre> invalid : {{ registerForm.value | json }} </pre>